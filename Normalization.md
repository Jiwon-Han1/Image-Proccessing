# 이미지 정규화
내가 보려고 정리한 일반적인 딥러닝 및 이미지 프로세싱에서의 이미지 정규화 방법들에 대한 정리
<br/><br/>

## 정규화 방법

### [0, 1] 정규화:
이미지의 픽셀 값을 [0, 1] 범위로 스케일링

- **예**:
  ```python
  image = image / 255.0  # 이미지 값이 0~255인 경우
  ```

### [-1, 1] 정규화:
이미지의 값을 [-1, 1] 범위로 스케일링

- **예**:
  ```python
  image = (image / 127.5) - 1 # 이미지 값이 0~255인 경우
  ```

### Z-score 정규화 (표준화):
이미지의 각 픽셀 값에서 평균을 빼고 표준 편차로 나누는 방식으로, 데이터가 평균 0, 표준 편차 1을 가지도록 스케일링

- **예**:
  ```python
  image = (image - mean) / std
  ```
- 일반적으로 사전 계산된 평균(mean)과 표준 편차(std)를 사용

### 클리핑 및 스케일링:
특정 범위 내로 값을 클리핑한 후, [0, 1] 또는 다른 범위로 스케일링

- **예**:
  ```python
  image = np.clip(image, min_val, max_val)
  image = (image - min_val) / (max_val - min_val)
  ```

### 히스토그램 균등화 (Histogram Equalization):
이미지의 명암을 균등하게 분포시키는 방법으로, 이미지의 contrast를 향상시킴

- **예**:
  ```python
  equalized_image = cv2.equalizeHist(image)
  ```

### 정규화 레이어 사용:
레이어들이 딥러닝 모델 내에서 feature map을 정규화

- **예**:
  배치 정규화(Batch Normalization), 레이어 정규화(Layer Normalization), 인스턴스 정규화(Instance Normalization) 등

정규화는 모델의 성능과 안정성을 크게 향상시키는 중요한 단계입니다. 위의 다양한 정규화 방법들은 특정 상황과 요구사항에 따라 선택적으로 사용할 수 있습니다. [0, 1] 정규화는 그 중에서도 가장 기본적이고 널리 사용되는 방법 중 하나입니다.

<br/>

## [0, 1] 정규화와 Z-score 정규화의 차이점

### [0, 1] 정규화:
[0, 1] 정규화는 이미지의 픽셀 값을 [0, 1] 범위로 스케일링합니다. 이 방법은 각 픽셀 값에서 최소 값을 빼고 최대 값과 최소 값의 차이로 나누는 방식입니다.

- **공식**: 
  \[
  \text{normalized\_image} = \frac{\text{image} - \text{min\_val}}{\text{max\_val} - \text{min\_val}}
  \]

- **결과**:
  - 최소 픽셀 값은 0이 되고, 최대 픽셀 값은 1이 됩니다.
  - 모든 픽셀 값은 0과 1 사이에 위치하게 됩니다.
  - 이미지의 명암비(contrast)가 원본 이미지와 동일하게 유지됩니다.

### Z-score 정규화:
Z-score 정규화는 이미지의 각 픽셀 값에서 평균을 빼고 표준 편차로 나누는 방식입니다. 이 방법은 데이터가 평균 0, 표준 편차 1을 가지도록 스케일링합니다.

- **공식**: 
  \[
  \text{normalized\_image} = \frac{\text{image} - \text{mean}}{\text{std}}
  \]

- **결과**:
  - 정규화된 값들은 평균이 0이고 표준 편차가 1이 되도록 변환됩니다.
  - 픽셀 값들은 -3에서 3 사이에 주로 분포하지만, 원래 데이터의 분포에 따라 범위는 달라질 수 있습니다.
  - 이미지의 명암비가 조정될 수 있으며, 평균 값 근처의 픽셀 값들은 더욱 집중되고, 평균에서 멀리 떨어진 값들은 더 넓게 분포됩니다.

### 이미지 상의 차이:
- **[0, 1] 정규화**:
  - 이미지의 전반적인 형태와 명암비가 원본 이미지와 거의 동일하게 유지됩니다.
  - 이미지의 밝기나 어두움이 원본과 비슷하게 나타납니다.
  - 대비가 유지되기 때문에 이미지의 디테일이 그대로 보입니다.

- **Z-score 정규화**:
  - 이미지의 평균 밝기가 0으로 설정되므로, 전체적으로 더 밝거나 어두워질 수 있습니다.
  - 표준 편차로 나누기 때문에 명암비가 조정되어 이미지의 대비가 변화할 수 있습니다.
  - 픽셀 값들이 평균에 집중되기 때문에, 이미지의 중앙 부분은 더 부드럽게 보일 수 있으며, 극단적인 값들은 더 강조될 수 있습니다.

### 시각적 예시:

#### [0, 1] 정규화
- 원본 이미지가 유지되는 범위 내에서 조정됩니다.
- 명암비가 동일하므로 디테일이 그대로 보입니다.

#### Z-score 정규화
- 평균이 0이 되고, 값들이 표준 편차에 따라 스케일링되므로 이미지의 명암이 다르게 보일 수 있습니다.
- 이미지의 밝기와 어두움이 변할 수 있으며, 극단적인 밝기나 어두운 부분이 더 강조되거나 덜 강조될 수 있습니다.

### 결론:
정규화 방법의 선택은 주로 특정 응용 프로그램의 요구 사항에 따라 달라집니다. [0, 1] 정규화는 이미지를 원본과 거의 동일하게 유지하는 반면, Z-score 정규화는 이미지의 통계적 특성을 표준화하여 모델이 데이터를 더 쉽게 학습하도록 도와줄 수 있습니다. 이로 인해, 이미지의 시각적 결과는 [0, 1] 정규화가 원본과 더 유사하게 보이는 반면, Z-score 정규화는 더 큰 변화를 초래할 수 있습니다.
```
